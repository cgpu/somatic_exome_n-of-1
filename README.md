# Exome N-of-1 Tumour-Normal Analysis
## Call SNV and CNA from multiple tumour sample exome data
### How to Run
#### Reference Generation
The NextFlow pipelines require references (fasta, indexes, etc.) to run. With dependencies NextFlow and Singularity installed, these can be generated by:
```
git clone https://github.com/brucemoran/DNAseq_references
cd DNAseq_references
nextflow run DNAseq_references.GRCh37.simg.nf \
  --exomebed "/local/full/path/to/exome.bed" \
  --cosmicCGCtsv "/local/full/path/to/COSMIC_Census.tsv" \
  -c DNAseq_references.GRCh37.simg.nextflow.config
```

#### Main pipeline
##### Exome N-of-1
To then run exome_n-of-1 pipeline:
```
nextflow run exome_n-of-1.simg.nf \
  --sampleCsv "sample.csv" \
  --refDir "DNAseq_references/GRCh37" \
  --includeOrder "tumour_A,tumour_B" \
  --sampleMeta "sample.meta.csv" \
  --germline
```
sample.csv has format:
```
type,sampleID,read1,read2
germline,germ1,/full/path/to/germ1.R1.fastq.gz,/full/path/to/germ1.R2.fastq.gz
somatic,soma1,/full/path/to/soma1.R1.fastq.gz,/full/path/to/soma1.R2.fastq.gz
somatic,soma2,/full/path/to/soma2.R1.fastq.gz,/full/path/to/soma2.R2.fastq.gz
```

sample.meta.csv has format:
```
sampleID,metaname
soma1,a certain type of somatic sample - identifier 1
soma2,a different type of somatic sample - identifier 2
```

metaname is used for reporting output, where he sampleID may include clincally sensitive patient data

N.B that headers of csv files must match exactly, and you must have only one germline/normal sample; please give type as 'germline' for the sake of it being correctly identified. Somatic matches anything that isn't 'germline'
